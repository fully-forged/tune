<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.24.2">
    <meta name="project" content="tune v0.1.0">

    <title>Tune — tune v0.1.0</title>
    <link rel="stylesheet" href="dist/elixir-a172fe91e725dcb259e2.css" />

    <script src="dist/sidebar_items-ea2a3f53b7.js"></script>

      <script src="docs_config.js"></script>

    <script async src="dist/app-f27ff079945e43879c46.js"></script>


  </head>
  <body data-type="extras">
    <script>

      try {
        if (localStorage.getItem('night-mode') === 'true') {
          document.body.classList.add('night-mode');
        }
      } catch (error) { }
    </script>

<div class="main">

<button class="sidebar-button sidebar-toggle">
  <span class="icon-menu" title="Collapse/expand sidebar"></span>
</button>

<section class="sidebar">
  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button" aria-label="Submit Search">
      <span class="icon-search" aria-hidden="true" title="Submit search"></span>
    </button>
    <button type="button" tabindex="-1" class="search-close-button" aria-label="Cancel Search">
      <span class="icon-cross" aria-hidden="true" title="Cancel search"></span>
    </button>
    <label class="search-label">
      <input name="q" type="text" class="search-input" placeholder="Search..." aria-label="Input your search terms" autocomplete="off" />
    </label>
  </form>

  <div class="autocomplete">
    <div class="autocomplete-results">
    </div>
  </div>

  <div class="sidebar-header">
    <div class="sidebar-projectDetails">
      <a href="readme.html" class="sidebar-projectName">
tune
      </a>
      <strong class="sidebar-projectVersion">
        v0.1.0
      </strong>
    </div>

  </div>

  <ul class="sidebar-listNav">
    <li><a id="extras-list-link" href="#full-list">Pages</a></li>

      <li><a id="modules-list-link" href="#full-list">Modules</a></li>


  </ul>
  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <div class="content-outer">
    <div id="content" class="content-inner">

<h1>Tune</h1><p><img src="https://github.com/fully-forged/tune/workflows/Tune%20CI/badge.svg" alt="CI Status"/></p><h2 id="about" class="section-heading">
  <a href="#about" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  About
</h2>
<p>Tune is a Spotify browser and remote application with a focus on performance
and integration with other services.</p><p>You can see it in action at <a href="https://tune.fullyforged.com">https://tune.fullyforged.com</a>.</p><h3 id="album-details" class="section-heading">
  <a href="#album-details" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Album details
</h3>
<p><img src="https://raw.githubusercontent.com/fully-forged/tune/main/screenshots/album-details.jpg" alt="Album details" title="Album details"/></p><h3 id="global-search" class="section-heading">
  <a href="#global-search" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Global Search
</h3>
<p><img src="https://raw.githubusercontent.com/fully-forged/tune/main/screenshots/search.jpg" alt="Search" title="Search"/></p><h3 id="artist-details" class="section-heading">
  <a href="#artist-details" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Artist details
</h3>
<p><img src="https://raw.githubusercontent.com/fully-forged/tune/main/screenshots/artist-details.jpg" alt="Artist details" title="Artist details"/></p><h3 id="top-albums-and-recommendations" class="section-heading">
  <a href="#top-albums-and-recommendations" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Top albums and recommendations
</h3>
<p><img src="https://raw.githubusercontent.com/fully-forged/tune/main/screenshots/top-albums-and-recommendations.jpg" alt="Top albums and recommendations" title="Top albums and recommendations"/></p><h3 id="release-radar" class="section-heading">
  <a href="#release-radar" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Release radar
</h3>
<p><img src="https://raw.githubusercontent.com/fully-forged/tune/main/screenshots/release-radar.jpg" alt="Release radar" title="Release radar"/></p><h2 id="usage" class="section-heading">
  <a href="#usage" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Usage
</h2>
<h3 id="scope-and-features" class="section-heading">
  <a href="#scope-and-features" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Scope and features
</h3>
<p>In many ways Tune copies the official Spotify application: many views (e.g.
search or details for artists and albums) are tightly based on the equivalent
sections in the Spotify application. This is an intentional choice aimed at
reducing friction between applications.</p><p>Tune differs in these areas:</p><ul><li>Performance: Tune is extremely light, as for the most part is a
server-rendered application, which makes it suitable to use on a wide range
of devices and operating systems (think Linux on a Raspberry PI). Most of its
functionality works without JavaScript and is exposed via a proper URL.</li><li>Integration: Tune tries to connect items like artists, albums or songs to
other sources of information, so that for example you can use convenient
links to read the history of a band on Wikipedia.</li><li>Recommendations: Tune offers suggestions based on a combination of what's
provided by Spotify and some custom logic (loosely based on what you've been
listening in a specific time period). The logic is an almost direct porting of
how I search for new music, so it might not work for you.</li></ul><h3 id="keyboard-shortcuts" class="section-heading">
  <a href="#keyboard-shortcuts" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Keyboard shortcuts
</h3>
<ul><li>&lt;kbd&gt;Space&lt;/kbd&gt;: Play/Pause</li><li>&lt;kbd&gt;h&lt;/kbd&gt;: Home</li><li>&lt;kbd&gt;a&lt;/kbd&gt;: Prev</li><li>&lt;kbd&gt;d&lt;/kbd&gt;: Next</li><li>&lt;kbd&gt;w&lt;/kbd&gt;: Volume up</li><li>&lt;kbd&gt;s&lt;/kbd&gt;: Volume down</li><li>&lt;kbd&gt;/&lt;/kbd&gt;: Focus search input</li><li>&lt;kbd&gt;q&lt;/kbd&gt;: Focus device selector</li><li>&lt;kbd&gt;n&lt;/kbd&gt;: When available, go to the next page</li><li>&lt;kbd&gt;p&lt;/kbd&gt;: When available, go to the previous page</li><li>&lt;kbd&gt;?&lt;/kbd&gt;: Display a modal dialog with available shortcuts</li></ul><h3 id="free-vs-premium-subscriptions" class="section-heading">
  <a href="#free-vs-premium-subscriptions" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Free vs. Premium Subscriptions
</h3>
<table><thead><tr><th style="text-align: left;">Feature</th><th style="text-align: center;">Free subscription</th><th style="text-align: center;">Premium Subscription</th></tr></thead><tbody><tr><td style="text-align: left;">Search</td><td style="text-align: center;">✅</td><td style="text-align: center;">✅</td></tr><tr><td style="text-align: left;">Artist/Album/etc. details</td><td style="text-align: center;">✅</td><td style="text-align: center;">✅</td></tr><tr><td style="text-align: left;">Suggestions</td><td style="text-align: center;">✅</td><td style="text-align: center;">✅</td></tr><tr><td style="text-align: left;">Release radar</td><td style="text-align: center;">✅</td><td style="text-align: center;">✅</td></tr><tr><td style="text-align: left;">Miniplayer controls</td><td style="text-align: center;">❌</td><td style="text-align: center;">✅</td></tr><tr><td style="text-align: left;">Device chooser</td><td style="text-align: center;">❌</td><td style="text-align: center;">✅</td></tr><tr><td style="text-align: left;">Embedded audio player</td><td style="text-align: center;">❌</td><td style="text-align: center;">✅ (on some browsers)</td></tr></tbody></table><p>Due to limitations imposed by Spotify, users with free subscriptions cannot use the embedded
audio player, nor they can control other devices via Tune's UI. If you have a
free subscription, those UI elements are not visible as they're ineffective.</p><p>For users with Premium subscriptions, Tune can be used as a standalone player by selecting the
appropriate option in the device switch section in the mini player (note that <a href="https://developer.spotify.com/documentation/web-playback-sdk/#supported-browsers">only some browsers are
supported</a>).</p><h3 id="data-retention-and-privacy" class="section-heading">
  <a href="#data-retention-and-privacy" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Data retention and privacy
</h3>
<p>Tune doesn't have any persistent storage: upon successful authentication,
credentials are only stored in your browser's cookies and kept in memory in the application.</p><p>Credentials are cleared at most 30 seconds after you close the last browser
session, even if you don't explicitly logout.</p><p>At this point in time, credentials may be printed in logs and/or crash reports.</p><h3 id="duplicated-content" class="section-heading">
  <a href="#duplicated-content" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Duplicated content
</h3>
<p>In some cases, search results or specific listings will display duplicated
content (e.g. the exact same album twice). This is due to the Spotify API
returning duplicated results which only differ in the ID.</p><p>It's not clear why this happens: it could be that the artist uploaded the same
album multiple times, it could be that different editions are available in
specific territories.</p><h3 id="issues-with-devices-and-playback" class="section-heading">
  <a href="#issues-with-devices-and-playback" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Issues with devices and playback
</h3>
<p>If you use Tune in combination with official Spotify clients, you will notice
that if nothing is playing, after a while the miniplayer controls stop
responding and you can't even play any song. This is due to a quirk in the
Spotify devices API, which reports client devices as still connected.</p><p>If you're running Tune on a platform where it can load the built-in audio
player, you can just refresh the page for the player to reload, which has the
side effect of &quot;waking up&quot; all other clients as well. At that point, you can
select them from the device switcher and resume normal operation.</p><p>If you're running Tune on a mobile device, your only option is to open the
dormant client application, do a quick play/pause to wake it up and go back
to Tune.</p><p>More information on the related <a href="https://developer.spotify.com/documentation/web-api/guides/using-connect-web-api/#devices-not-appearing-on-device-list">Spotify documentation
page</a>.</p><h2 id="development" class="section-heading">
  <a href="#development" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Development
</h2>
<h3 id="setup" class="section-heading">
  <a href="#setup" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Setup
</h3>
<p>First of all, we need working installations of Elixir and Erlang. The
recommended way to achieve this is via <a href="https://asdf-vm.com/#/">asdf</a>. Once
it's installed and working, you can run <code class="inline">asdf install</code> from the project root to
install the correct versions required (see the <code class="inline">.tool-versions</code> file for
details).</p><p>Next, make sure you setup the required environment variables as detailed in
<code class="inline">.env</code> by copying the file to <code class="inline">.env.local</code> and adjusting values as needed.</p><p>Please see the <a href="https://hexdocs.pm/vapor/Vapor.Provider.Dotenv.html#content">Vapor
docs</a> for more
detail on the dotenv configuration provider.</p><p>To create secrets, (e.g. for <code class="inline">SECRET_KEY_BASE</code>), use <a href="https://hexdocs.pm/phoenix/1.5.9/Mix.Tasks.Phx.Gen.Secret.html"><code class="inline">mix phx.gen.secret</code></a>.</p><p>Next you can install all dependencies with <code class="inline">mix setup</code>.</p><h3 id="running-the-application" class="section-heading">
  <a href="#running-the-application" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Running the application
</h3>
<ul><li>Start the application with <a href="https://hexdocs.pm/phoenix/1.5.9/Mix.Tasks.Phx.Server.html"><code class="inline">mix phx.server</code></a></li><li>To start the application and an IEx console connected to it, use <code class="inline">iex -S mix phx.server</code></li></ul><p>Now you can visit <a href="http://localhost:4000"><code class="inline">localhost:4000</code></a> from your browser.</p><h3 id="tests-dialyzer-and-credo" class="section-heading">
  <a href="#tests-dialyzer-and-credo" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Tests, dialyzer and Credo
</h3>
<p>You can run tests with <a href="https://hexdocs.pm/mix/Mix.Tasks.Test.html"><code class="inline">mix test</code></a>, dialyzer with <a href="https://hexdocs.pm/dialyxir/1.1.0/Mix.Tasks.Dialyzer.html"><code class="inline">mix dialyzer</code></a> and Credo with <a href="https://hexdocs.pm/credo/1.5.6/Mix.Tasks.Credo.html"><code class="inline">mix credo</code></a>.</p><p>The application also includes a minimal JS test suite (currently used as a
playground to understand how to effectively test Phoenix LiveView hooks). You
can run it with <code class="inline">cd assets</code> and then <code class="inline">npm test</code>.</p><h3 id="documentation" class="section-heading">
  <a href="#documentation" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Documentation
</h3>
<p>Available at <a href="https://tune-docs.fullyforged.com">https://tune-docs.fullyforged.com</a>, gets automatically updated
with every push on the <code class="inline">main</code> branch.</p><h3 id="application-structure" class="section-heading">
  <a href="#application-structure" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Application structure
</h3>
<p>The <code class="inline">Tune</code> namespace defines the domain logic responsible to interact with the
Spotify API and maintain running sessions for each logged-in user.</p><p>The <code class="inline">TuneWeb</code> namespace defines authentication endpoints and the main
<code class="inline">LiveView</code> (<a href="TuneWeb.ExplorerLive.html"><code class="inline">TuneWeb.ExplorerLive</code></a>) that powers the entire user interface.</p><p>Tune assumes multiple browser sessions for the same user, which is why it
defines a <a href="Tune.Spotify.Session.html"><code class="inline">Tune.Spotify.Session</code></a> behaviour with <a href="Tune.Spotify.Session.HTTP.html"><code class="inline">Tune.Spotify.Session.HTTP</code></a>
as its main runtime implementation.</p><p>Each worker is responsible to proxy interaction with the Spotify API, 
periodically poll for data changes, and broadcast corresponding events.</p><p>When a user opens a browser session, <a href="TuneWeb.ExplorerLive.html"><code class="inline">TuneWeb.ExplorerLive</code></a> either starts or
simply reuses a worker named with the same session ID.</p><p>Each worker monitors its subscribers, so that it can shutdown when a user
closes their last browser window.</p><p>This architecture ensures that:</p><ul><li>The amount of automatic API calls against the Spotify API for a given user is
constant and independent from the number of user sessions for the same user.</li><li>Credential renewal happens in the background</li><li>The explorer implementation remains entirely focused on UI interaction </li></ul><h3 id="telemetry" class="section-heading">
  <a href="#telemetry" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Telemetry
</h3>
<p>The application exposes <code class="inline">TuneWeb.Telemetry</code> module with definitions for relevant metrics.</p><p>An instance of
<a href="https://github.com/phoenixframework/phoenix_live_dashboard/">Phoenix.LiveDashboard</a>
is mounted at <code class="inline">/dashboard</code>. In production, the endpoint is protected by basic
auth (see <code class="inline">.env</code> for relevant environment variables).</p><h2 id="deployment" class="section-heading">
  <a href="#deployment" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Deployment
</h2>
<p>The project is setup to deploy on Heroku, please make sure you:</p><ul><li>configure environment variables</li><li>add the buildpacks detailed at <a href="https://hexdocs.pm/phoenix/heroku.html">https://hexdocs.pm/phoenix/heroku.html</a></li><li>to enable exception tracking via <a href="https://sentry.io">Sentry</a>, make sure you define a <code class="inline">SENTRY_DSN</code> environment variable</li><li>to enable metrics tracking via <a href="https://appsignal.com">AppSignal</a>, make sure you defined the environment variables listed at <a href="https://docs.appsignal.com/elixir/configuration/#minimal-required-configuration">https://docs.appsignal.com/elixir/configuration/#minimal-required-configuration</a></li></ul><h2 id="credits" class="section-heading">
  <a href="#credits" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Credits
</h2>
<p>All content and metadata is provided by Spotify unless explicitly stated.
Content is owned by many different right holders.</p><p>Icons:</p><ul><li>Spotify icon by
<a href="https://developer.spotify.com/documentation/general/design-and-branding/#using-our-logo
"Spotify Logo"">Spotify</a></li><li>Wikipedia icon by <a href="https://www.flaticon.com/authors/freepik
"Freepik"">Freepik</a> from <a href="https://www.flaticon.com/" title="Flaticon">www.flaticon.com</a></li><li>Last.fm icon by <a href="https://www.flaticon.com/authors/pixel-perfect" title="Pixel perfect">Pixel
perfect</a> from
<a href="https://www.flaticon.com/" title="Flaticon">www.flaticon.com</a></li><li>YouTube icon by <a href="https://www.flaticon.com/authors/freepik
"Freepik"">Freepik</a> from <a href="https://www.flaticon.com/" title="Flaticon">www.flaticon.com</a></li><li>All remaining icons from <a href="https://remixicon.com/">Remix Icon</a></li></ul><h2 id="code-of-conduct" class="section-heading">
  <a href="#code-of-conduct" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Code of Conduct
</h2>
<p>Available at <a href="https://github.com/fully-forged/tune/blob/main/CODE_OF_CONDUCT.md">https://github.com/fully-forged/tune/blob/main/CODE_OF_CONDUCT.md</a>.</p><h2 id="license" class="section-heading">
  <a href="#license" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  License
</h2>
<p>Available at <a href="https://github.com/fully-forged/tune/blob/main/LICENSE">https://github.com/fully-forged/tune/blob/main/LICENSE</a>.</p>
<div class="bottom-actions">
  <div class="bottom-actions-item">

      <a href="api-reference.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ← Previous Page
        </span>
        <span class="title">
API Reference
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

  </div>
</div>

      <footer class="footer">
        <p>
          <span class="line">
            Built using
            <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener">ExDoc</a> (v0.24.2) for the
            <a href="https://elixir-lang.org" title="Elixir" target="_blank">Elixir programming language</a>.
          </span>
          <span class="line">
            Designed by
            <a href="https://twitter.com/dignifiedquire" target="_blank" rel="noopener" title="@dignifiedquire">Friedel Ziegelmayer</a>.
          </span>
        </p>
        <p>

            <a href="api-reference.html" title="API reference" class="line footer-button">API Reference</a>

          <button class="line footer-button display-shortcuts-help">
            Display keyboard shortcuts
          </button>
          <button class="line footer-button night-mode-toggle">
            Toggle night mode
          </button>
          <button class="line footer-button display-quick-switch">
            Go to a HexDocs package
          </button>
          <button class="line footer-button tooltips-toggle">
            <span class="tooltips-option-disable">Disable tooltips</span>
            <span class="tooltips-option-enable">Enable tooltips</span>
          </button>
        </p>
      </footer>
    </div>
  </div>
</section>
</div>

<style>
  .content-inner code {
    font-family: IBM Plex Mono, Fira Code, Inconsolata,Menlo,Courier,monospace;
  }
</style>

  </body>
</html>
